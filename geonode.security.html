<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>geonode.security package &mdash; GeoNode Cloud Core 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=8d563738"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="geonode.services package" href="geonode.services.html" />
    <link rel="prev" title="geonode.resource.processing.migrations package" href="geonode.resource.processing.migrations.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            GeoNode Cloud Core
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">geonode-cloud-core</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="create-envfile.html">create-envfile module</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="geonode.html">geonode package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="geonode.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="geonode.api.html">geonode.api package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.base.html">geonode.base package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.br.html">geonode.br package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.catalogue.html">geonode.catalogue package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.client.html">geonode.client package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.documents.html">geonode.documents package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.facets.html">geonode.facets package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.favorite.html">geonode.favorite package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.geoapps.html">geonode.geoapps package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.geoserver.html">geonode.geoserver package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.groups.html">geonode.groups package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.harvesting.html">geonode.harvesting package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.invitations.html">geonode.invitations package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.layers.html">geonode.layers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.management_commands_http.html">geonode.management_commands_http package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.maps.html">geonode.maps package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.messaging.html">geonode.messaging package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.monitoring.html">geonode.monitoring package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.people.html">geonode.people package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.proxy.html">geonode.proxy package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.resource.html">geonode.resource package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">geonode.security package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.services.html">geonode.services package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.social.html">geonode.social package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.storage.html">geonode.storage package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.tasks.html">geonode.tasks package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.tests.html">geonode.tests package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.themes.html">geonode.themes package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.thumbs.html">geonode.thumbs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="geonode.upload.html">geonode.upload package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#module-geonode.apps">geonode.apps module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#module-geonode.celery_app">geonode.celery_app module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#module-geonode.compat">geonode.compat module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#geonode-context-processors-module">geonode.context_processors module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#module-geonode.custom_translations">geonode.custom_translations module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#geonode-decorators-module">geonode.decorators module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#geonode-loaders-module">geonode.loaders module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#geonode-notifications-backend-module">geonode.notifications_backend module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#module-geonode.notifications_helper">geonode.notifications_helper module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#module-geonode.serializer">geonode.serializer module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#geonode-settings-module">geonode.settings module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#module-geonode.singleton">geonode.singleton module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#geonode-sitemap-module">geonode.sitemap module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#geonode-urls-module">geonode.urls module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#geonode-utils-module">geonode.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#module-geonode.version">geonode.version module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#geonode-views-module">geonode.views module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#module-geonode.wsgi">geonode.wsgi module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geonode.html#module-geonode">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="manage.html">manage module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pavement.html">pavement module</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html">setup module</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks.html">tasks module</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GeoNode Cloud Core</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">geonode-cloud-core</a></li>
          <li class="breadcrumb-item"><a href="geonode.html">geonode package</a></li>
      <li class="breadcrumb-item active">geonode.security package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/geonode.security.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="geonode-security-package">
<h1>geonode.security package<a class="headerlink" href="#geonode-security-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-geonode.security.apps">
<span id="geonode-security-apps-module"></span><h2>geonode.security.apps module<a class="headerlink" href="#module-geonode.security.apps" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="geonode.security.apps.GeoNodeSecurityAppConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geonode.security.apps.</span></span><span class="sig-name descname"><span class="pre">GeoNodeSecurityAppConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">app_module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/apps.html#GeoNodeSecurityAppConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.apps.GeoNodeSecurityAppConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AppConfig</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="geonode.security.apps.GeoNodeSecurityAppConfig.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'geonode.security'</span></em><a class="headerlink" href="#geonode.security.apps.GeoNodeSecurityAppConfig.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonode.security.apps.GeoNodeSecurityAppConfig.verbose_name">
<span class="sig-name descname"><span class="pre">verbose_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'GeoNode</span> <span class="pre">Security'</span></em><a class="headerlink" href="#geonode.security.apps.GeoNodeSecurityAppConfig.verbose_name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="geonode-security-backends-module">
<h2>geonode.security.backends module<a class="headerlink" href="#geonode-security-backends-module" title="Link to this heading"></a></h2>
</section>
<section id="geonode-security-middleware-module">
<h2>geonode.security.middleware module<a class="headerlink" href="#geonode-security-middleware-module" title="Link to this heading"></a></h2>
</section>
<section id="geonode-security-models-module">
<h2>geonode.security.models module<a class="headerlink" href="#geonode-security-models-module" title="Link to this heading"></a></h2>
</section>
<section id="module-geonode.security.oauth2_grant_types">
<span id="geonode-security-oauth2-grant-types-module"></span><h2>geonode.security.oauth2_grant_types module<a class="headerlink" href="#module-geonode.security.oauth2_grant_types" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geonode.security.oauth2_grant_types.</span></span><span class="sig-name descname"><span class="pre">OAuth2AuthorizationCodeGrant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request_validator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/oauth2_grant_types.html#OAuth2AuthorizationCodeGrant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GrantTypeBase</span></code></p>
<p><a class="reference external" href="https://tools.ietf.org/html/rfc6749#section-4.1">Authorization Code Grant</a></p>
<p>The authorization code grant type is used to obtain both access
tokens and refresh tokens and is optimized for confidential clients.
Since this is a redirection-based flow, the client must be capable of
interacting with the resource owner’s user-agent (typically a web
browser) and capable of receiving incoming requests (via redirection)
from the authorization server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+----------+</span>
<span class="o">|</span> <span class="n">Resource</span> <span class="o">|</span>
<span class="o">|</span>   <span class="n">Owner</span>  <span class="o">|</span>
<span class="o">|</span>          <span class="o">|</span>
<span class="o">+----------+</span>
     <span class="o">^</span>
     <span class="o">|</span>
    <span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="o">+----|-----+</span>          <span class="n">Client</span> <span class="n">Identifier</span>      <span class="o">+---------------+</span>
<span class="o">|</span>         <span class="o">-+----</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">--</span> <span class="o">&amp;</span> <span class="n">Redirection</span> <span class="n">URI</span> <span class="o">----&gt;|</span>               <span class="o">|</span>
<span class="o">|</span>  <span class="n">User</span><span class="o">-</span>   <span class="o">|</span>                                 <span class="o">|</span> <span class="n">Authorization</span> <span class="o">|</span>
<span class="o">|</span>  <span class="n">Agent</span>  <span class="o">-+----</span><span class="p">(</span><span class="n">B</span><span class="p">)</span><span class="o">--</span> <span class="n">User</span> <span class="n">authenticates</span> <span class="o">---&gt;|</span>     <span class="n">Server</span>    <span class="o">|</span>
<span class="o">|</span>          <span class="o">|</span>                                 <span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span>         <span class="o">-+----</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="o">--</span> <span class="n">Authorization</span> <span class="n">Code</span> <span class="o">---&lt;|</span>               <span class="o">|</span>
<span class="o">+-|----|---+</span>                                 <span class="o">+---------------+</span>
  <span class="o">|</span>    <span class="o">|</span>                                         <span class="o">^</span>      <span class="n">v</span>
 <span class="p">(</span><span class="n">A</span><span class="p">)</span>  <span class="p">(</span><span class="n">C</span><span class="p">)</span>                                        <span class="o">|</span>      <span class="o">|</span>
  <span class="o">|</span>    <span class="o">|</span>                                         <span class="o">|</span>      <span class="o">|</span>
  <span class="o">^</span>    <span class="n">v</span>                                         <span class="o">|</span>      <span class="o">|</span>
<span class="o">+---------+</span>                                      <span class="o">|</span>      <span class="o">|</span>
<span class="o">|</span>         <span class="o">|&gt;---</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">--</span> <span class="n">Authorization</span> <span class="n">Code</span> <span class="o">---------</span><span class="s1">&#39;      |</span>
<span class="o">|</span>  <span class="n">Client</span> <span class="o">|</span>          <span class="o">&amp;</span> <span class="n">Redirection</span> <span class="n">URI</span>                  <span class="o">|</span>
<span class="o">|</span>         <span class="o">|</span>                                             <span class="o">|</span>
<span class="o">|</span>         <span class="o">|&lt;---</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="o">-----</span> <span class="n">Access</span> <span class="n">Token</span> <span class="o">-------------------</span><span class="s1">&#39;</span>
<span class="o">+---------+</span>       <span class="p">(</span><span class="n">w</span><span class="o">/</span> <span class="n">Optional</span> <span class="n">Refresh</span> <span class="n">Token</span><span class="p">)</span>
</pre></div>
</div>
<p>Note: The lines illustrating steps (A), (B), and (C) are broken into
two parts as they pass through the user-agent.</p>
<p>Figure 3: Authorization Code Flow</p>
<p>The flow illustrated in Figure 3 includes the following steps:</p>
<ol class="upperalpha simple">
<li><p>The client initiates the flow by directing the resource owner’s
user-agent to the authorization endpoint.  The client includes
its client identifier, requested scope, local state, and a
redirection URI to which the authorization server will send the
user-agent back once access is granted (or denied).</p></li>
<li><p>The authorization server authenticates the resource owner (via
the user-agent) and establishes whether the resource owner
grants or denies the client’s access request.</p></li>
<li><p>Assuming the resource owner grants access, the authorization
server redirects the user-agent back to the client using the
redirection URI provided earlier (in the request or during
client registration).  The redirection URI includes an
authorization code and any local state provided by the client
earlier.</p></li>
<li><p>The client requests an access token from the authorization
server’s token endpoint by including the authorization code
received in the previous step.  When making the request, the
client authenticates with the authorization server.  The client
includes the redirection URI used to obtain the authorization
code for verification.</p></li>
<li><p>The authorization server authenticates the client, validates the
authorization code, and ensures that the redirection URI
received matches the URI used to redirect the client in
step (C).  If valid, the authorization server responds back with
an access token and, optionally, a refresh token.</p></li>
</ol>
<p>OAuth 2.0 public clients utilizing the Authorization Code Grant are
susceptible to the authorization code interception attack.</p>
<p>A technique to mitigate against the threat through the use of Proof Key for Code
Exchange (PKCE, pronounced “pixy”) is implemented in the current oauthlib
implementation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.create_authorization_code">
<span class="sig-name descname"><span class="pre">create_authorization_code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/oauth2_grant_types.html#OAuth2AuthorizationCodeGrant.create_authorization_code"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.create_authorization_code" title="Link to this definition"></a></dt>
<dd><p>Generates an authorization grant represented as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>oauthlib.common.Request</em>) – OAuthlib request.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.create_authorization_response">
<span class="sig-name descname"><span class="pre">create_authorization_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_handler</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/oauth2_grant_types.html#OAuth2AuthorizationCodeGrant.create_authorization_response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.create_authorization_response" title="Link to this definition"></a></dt>
<dd><p>The client constructs the request URI by adding the following
parameters to the query component of the authorization endpoint URI
using the “application/x-www-form-urlencoded” format, per <a class="reference external" href="https://tools.ietf.org/html/rfc6749#appendix-B">Appendix B</a>:</p>
<dl class="simple">
<dt>response_type</dt><dd><p>REQUIRED.  Value MUST be set to “code” for standard OAuth2
authorization flow.  For OpenID Connect it must be one of
“code token”, “code id_token”, or “code token id_token” - we
essentially test that “code” appears in the response_type.</p>
</dd>
<dt>client_id</dt><dd><p>REQUIRED.  The client identifier as described in <a class="reference external" href="https://tools.ietf.org/html/rfc6749#section-2.2">Section 2.2</a>.</p>
</dd>
<dt>redirect_uri</dt><dd><p>OPTIONAL.  As described in <a class="reference external" href="https://tools.ietf.org/html/rfc6749#section-3.1.2">Section 3.1.2</a>.</p>
</dd>
<dt>scope</dt><dd><p>OPTIONAL.  The scope of the access request as described by
<a class="reference external" href="https://tools.ietf.org/html/rfc6749#section-3.3">Section 3.3</a>.</p>
</dd>
<dt>state</dt><dd><p>RECOMMENDED.  An opaque value used by the client to maintain
state between the request and callback.  The authorization
server includes this value when redirecting the user-agent back
to the client.  The parameter SHOULD be used for preventing
cross-site request forgery as described in <a class="reference external" href="https://tools.ietf.org/html/rfc6749#section-10.12">Section 10.12</a>.</p>
</dd>
</dl>
<p>The client directs the resource owner to the constructed URI using an
HTTP redirection response, or by other means available to it via the
user-agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<em>oauthlib.common.Request</em>) – OAuthlib request.</p></li>
<li><p><strong>token_handler</strong> – A token handler instance, for example of type
oauthlib.oauth2.BearerToken.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>headers, body, status</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p>FatalClientError on invalid redirect URI or client id.</p>
</dd>
</dl>
<p>A few examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">your_validator</span> <span class="kn">import</span> <span class="n">your_validator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s1">&#39;https://example.com/authorize?client_id=valid&#39;</span>
<span class="gp">... </span>                  <span class="s1">&#39;&amp;redirect_uri=http%3A</span><span class="si">%2F%2F</span><span class="s1">client.com</span><span class="si">%2F</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">oauthlib.common</span> <span class="kn">import</span> <span class="n">Request</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">oauthlib.oauth2</span> <span class="kn">import</span> <span class="n">AuthorizationCodeGrant</span><span class="p">,</span> <span class="n">BearerToken</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">token</span> <span class="o">=</span> <span class="n">BearerToken</span><span class="p">(</span><span class="n">your_validator</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grant</span> <span class="o">=</span> <span class="n">AuthorizationCodeGrant</span><span class="p">(</span><span class="n">your_validator</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">request</span><span class="o">.</span><span class="n">scopes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;authorized&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;some&#39;</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grant</span><span class="o">.</span><span class="n">create_authorization_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
<span class="go">(u&#39;http://client.com/?error=invalid_request&amp;error_description=Missing+response_type+parameter.&#39;,</span>
<span class="go">None, None, 400)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s1">&#39;https://example.com/authorize?client_id=valid&#39;</span>
<span class="gp">... </span>                  <span class="s1">&#39;&amp;redirect_uri=http%3A</span><span class="si">%2F%2F</span><span class="s1">client.com</span><span class="si">%2F</span><span class="s1">&#39;</span>
<span class="gp">... </span>                  <span class="s1">&#39;&amp;response_type=code&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">request</span><span class="o">.</span><span class="n">scopes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;authorized&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;some&#39;</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grant</span><span class="o">.</span><span class="n">create_authorization_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
<span class="go">(u&#39;http://client.com/?code=u3F05aEObJuP2k7DordviIgW5wl52N&#39;, None, None, 200)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># If the client id or redirect uri fails validation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grant</span><span class="o">.</span><span class="n">create_authorization_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;oauthlib/oauth2/rfc6749/grant_types.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">515</span><span class="p">,</span> <span class="ow">in</span> <span class="n">create_authorization_response</span>
<span class="w">    </span>    <span class="o">&gt;&gt;&gt;</span> <span class="n">grant</span><span class="o">.</span><span class="n">create_authorization_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;oauthlib/oauth2/rfc6749/grant_types.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">591</span><span class="p">,</span> <span class="ow">in</span> <span class="n">validate_authorization_request</span>
<span class="gr">oauthlib.oauth2.rfc6749.errors.InvalidClientIdError</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.create_token_response">
<span class="sig-name descname"><span class="pre">create_token_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_handler</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/oauth2_grant_types.html#OAuth2AuthorizationCodeGrant.create_token_response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.create_token_response" title="Link to this definition"></a></dt>
<dd><p>Validate the authorization code.</p>
<p>The client MUST NOT use the authorization code more than once. If an
authorization code is used more than once, the authorization server
MUST deny the request and SHOULD revoke (when possible) all tokens
previously issued based on that authorization code. The authorization
code is bound to the client identifier and redirection URI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<em>oauthlib.common.Request</em>) – OAuthlib request.</p></li>
<li><p><strong>token_handler</strong> – A token handler instance, for example of type
oauthlib.oauth2.BearerToken.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.default_response_mode">
<span class="sig-name descname"><span class="pre">default_response_mode</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'query'</span></em><a class="headerlink" href="#geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.default_response_mode" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.response_types">
<span class="sig-name descname"><span class="pre">response_types</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['code']</span></em><a class="headerlink" href="#geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.response_types" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.validate_authorization_request">
<span class="sig-name descname"><span class="pre">validate_authorization_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/oauth2_grant_types.html#OAuth2AuthorizationCodeGrant.validate_authorization_request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.validate_authorization_request" title="Link to this definition"></a></dt>
<dd><p>Check the authorization request for normal and fatal errors.</p>
<p>A normal error could be a missing response_type parameter or the client
attempting to access scope it is not allowed to ask authorization for.
Normal errors can safely be included in the redirection URI and
sent back to the client.</p>
<p>Fatal errors occur when the client_id or redirect_uri is invalid or
missing. These must be caught by the provider and handled, how this
is done is outside of the scope of OAuthLib but showing an error
page describing the issue is a good idea.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>oauthlib.common.Request</em>) – OAuthlib request.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.validate_code_challenge">
<span class="sig-name descname"><span class="pre">validate_code_challenge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">challenge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">challenge_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verifier</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/oauth2_grant_types.html#OAuth2AuthorizationCodeGrant.validate_code_challenge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.validate_code_challenge" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.validate_token_request">
<span class="sig-name descname"><span class="pre">validate_token_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/oauth2_grant_types.html#OAuth2AuthorizationCodeGrant.validate_token_request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.oauth2_grant_types.OAuth2AuthorizationCodeGrant.validate_token_request" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>oauthlib.common.Request</em>) – OAuthlib request.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.OpenIDAuthorizationCodeGrant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geonode.security.oauth2_grant_types.</span></span><span class="sig-name descname"><span class="pre">OpenIDAuthorizationCodeGrant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request_validator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/oauth2_grant_types.html#OpenIDAuthorizationCodeGrant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.oauth2_grant_types.OpenIDAuthorizationCodeGrant" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GrantTypeBase</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.OpenIDAuthorizationCodeGrant.add_id_token">
<span class="sig-name descname"><span class="pre">add_id_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_handler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/oauth2_grant_types.html#OpenIDAuthorizationCodeGrant.add_id_token"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.oauth2_grant_types.OpenIDAuthorizationCodeGrant.add_id_token" title="Link to this definition"></a></dt>
<dd><p>Construct an initial version of id_token, and let the
request_validator sign or encrypt it.</p>
<p>The authorization_code version of this method is used to
retrieve the nonce accordingly to the code storage.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.code_challenge_method_plain">
<span class="sig-prename descclassname"><span class="pre">geonode.security.oauth2_grant_types.</span></span><span class="sig-name descname"><span class="pre">code_challenge_method_plain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verifier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">challenge</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/oauth2_grant_types.html#code_challenge_method_plain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.oauth2_grant_types.code_challenge_method_plain" title="Link to this definition"></a></dt>
<dd><p>If the “code_challenge_method” from <a class="reference external" href="https://tools.ietf.org/html/rfc7636#section-4.3">Section 4.3</a> was “plain”, they are
compared directly, i.e.:</p>
<p>code_verifier == code_challenge.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="geonode.security.oauth2_grant_types.code_challenge_method_s256">
<span class="sig-prename descclassname"><span class="pre">geonode.security.oauth2_grant_types.</span></span><span class="sig-name descname"><span class="pre">code_challenge_method_s256</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verifier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">challenge</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/oauth2_grant_types.html#code_challenge_method_s256"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.oauth2_grant_types.code_challenge_method_s256" title="Link to this definition"></a></dt>
<dd><p>If the “code_challenge_method” from <a class="reference external" href="https://tools.ietf.org/html/rfc7636#section-4.3">Section 4.3</a> was “S256”, the
received “code_verifier” is hashed by SHA-256, base64url-encoded, and
then compared to the “code_challenge”, i.e.:</p>
<p>BASE64URL-ENCODE(SHA256(ASCII(code_verifier))) == code_challenge</p>
<p>How to implement a base64url-encoding
function without padding, based upon the standard base64-encoding
function that uses padding.</p>
<p>To be concrete, example C# code implementing these functions is shown
below.  Similar code could be used in other languages.</p>
<p>static string base64urlencode(byte [] arg)
{</p>
<blockquote>
<div><p>string s = Convert.ToBase64String(arg); // Regular base64 encoder
s = s.Split(‘=’)[0]; // Remove any trailing ‘=’s
s = s.Replace(‘+’, ‘-‘); // 62nd char of encoding
s = s.Replace(‘/’, ‘_’); // 63rd char of encoding
return s;</p>
</div></blockquote>
<p>}</p>
<p>In python urlsafe_b64encode is already replacing ‘+’ and ‘/’, but preserve
the trailing ‘=’. So we have to remove it.</p>
</dd></dl>

</section>
<section id="module-geonode.security.oauth2_servers">
<span id="geonode-security-oauth2-servers-module"></span><h2>geonode.security.oauth2_servers module<a class="headerlink" href="#module-geonode.security.oauth2_servers" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="geonode.security.oauth2_servers.OIDCServer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geonode.security.oauth2_servers.</span></span><span class="sig-name descname"><span class="pre">OIDCServer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request_validator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_expires_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_generator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refresh_token_generator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/geonode/security/oauth2_servers.html#OIDCServer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geonode.security.oauth2_servers.OIDCServer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AuthorizationEndpoint</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">IntrospectEndpoint</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TokenEndpoint</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ResourceEndpoint</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RevocationEndpoint</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">UserInfoEndpoint</span></code></p>
<p>An all-in-one endpoint featuring all four major grant types.</p>
</dd></dl>

</section>
<section id="geonode-security-oauth2-validators-module">
<h2>geonode.security.oauth2_validators module<a class="headerlink" href="#geonode-security-oauth2-validators-module" title="Link to this heading"></a></h2>
</section>
<section id="geonode-security-permissions-module">
<h2>geonode.security.permissions module<a class="headerlink" href="#geonode-security-permissions-module" title="Link to this heading"></a></h2>
</section>
<section id="geonode-security-tests-module">
<h2>geonode.security.tests module<a class="headerlink" href="#geonode-security-tests-module" title="Link to this heading"></a></h2>
</section>
<section id="geonode-security-urls-module">
<h2>geonode.security.urls module<a class="headerlink" href="#geonode-security-urls-module" title="Link to this heading"></a></h2>
</section>
<section id="geonode-security-utils-module">
<h2>geonode.security.utils module<a class="headerlink" href="#geonode-security-utils-module" title="Link to this heading"></a></h2>
</section>
<section id="geonode-security-views-module">
<h2>geonode.security.views module<a class="headerlink" href="#geonode-security-views-module" title="Link to this heading"></a></h2>
</section>
<section id="module-geonode.security">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-geonode.security" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="geonode.resource.processing.migrations.html" class="btn btn-neutral float-left" title="geonode.resource.processing.migrations package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="geonode.services.html" class="btn btn-neutral float-right" title="geonode.services package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Kan Territory &amp; IT.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>